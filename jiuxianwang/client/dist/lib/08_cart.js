"use strict";$(function(){var s,t,a,e=(s="user_id",t=document.cookie,a={},t.split("; ").forEach(function(s){var t=s.split("="),i=t[0],e=t[1];a[i]=e}),a[s]);function i(){$.ajax({type:"get",url:"../../../server/cart.php",data:"type=get&user_id="+e,dataType:"json",success:function(s){var t;t=s.map(function(s){return'<div class="rsCartItem clearfix">\n            <div class="cartItemInfo info01">\n            <div class="rsCartCom-pic">\n            <a href="./07_detail.html?img='+s.src+"&title="+s.proName+"&price="+s.price+"&judge="+s.judge+"&goods_id="+s.id+'" target="_blank">\n            <img alt='+s.proName.slice(0,10)+" src="+s.src+" data-goods-id="+s.id+'></a></div>\n            <div class="rsCartCom-name">\n                <p><a href=./07_detail.html?img='+s.src+"&title="+s.proName+"&price="+s.price+"&judge="+s.judge+"&goods_id="+s.id+' target="_blank"\n                title='+s.proName+">"+s.proName+'</a></p>\n            </div>\n            </div>\n            <div class="cartItemInfo info02">\n                <div class="comAmount">\n                    <a href="javascript:;" class="calc dec">-</a>\n                    <span id="xgnum">'+s.num+'</span>\n                    <a href="javascript:;" class="calc plus">+</a>\n                </div>\n            </div>\n            <div class="cartItemInfo info03">￥'+s.price+'</div>\n            <div class="cartItemInfo info04">￥'+(s.price*s.num).toFixed(2)+'</div>\n            <div class="del">×\n            </div>\n        </div>'}).join(""),$("#rsCartTable").html(t),c()}})}function n(){$.ajax({type:"get",url:"../../../server/cart.php",data:"type=getCount&user_id="+e,dataType:"json",success:function(s){"success"==s.status&&($(".rsCartTotal .amountAll b").text(s.count),$(".jx_car_num").text(s.count))}})}function r(t,i){var s=$(t).parents(".rsCartItem").children(".info01").find("img").data("goods-id");$.ajax({type:"get",url:"../../../server/cart.php",data:"type=update&user_id="+e+"&goods_id="+s+"&count="+i,dataType:"json",success:function(s){$(t).siblings("#xgnum").text(i),n(),c()}})}function c(){var i=0;$(".rsCartTable").find(".rsCartItem").each(function(){var s=1*$(this).children(".info02").find("#xgnum").text(),t=1*$(this).find(".info03").text().slice(1);i+=s*t}),$("#priAll span").text(i.toFixed(2))}n(),i(),$(".rSidebarItem").mouseenter(function(){$(this).children("a").addClass("on"),$(this).siblings().children(".rSidebarItem a").removeClass("on")}),$(".rSidebarItem").mouseleave(function(){$(this).children("a").removeClass("on")}),$(".rsCartTable").on("mouseenter",".rsCartItem",function(){$(this).addClass("bgc").siblings().removeClass("bgc"),$(this).children().find(".calc").css({color:"#666666",border:"1px solid #cccccc"}),$(this).siblings().children().find(".calc").css({color:"#ffffff",border:"1px solid #ffffff"}),$(this).children(".del").css("display","block"),$(this).siblings().children(".del").css("display","none")}),$(".rsCartTable").on("mouseleave",".rsCartItem",function(){$(this).removeClass("bgc"),$(this).children().find(".calc").css({color:"#ffffff",border:"1px solid #ffffff"}),$(this).children(".del").css("display","none")}),$(".rsCartTable").on("click",".plus",function(){var s=1*$(this).siblings("#xgnum").text();99<=(s+=1)&&(s=99),$(this).siblings("#xgnum").text(s),r(this,s)}),$(".rsCartTable").on("click",".dec",function(){var s=1*$(this).siblings("#xgnum").text();(s-=1)<=1&&(s=1),$(this).siblings("#xgnum").text(s-1),r(this,s)}),$(".rsCartTable").on("click",".del",function(){var s=$(this).parents(".rsCartItem").children(".info01").find("img").data("goods-id");$.ajax({type:"get",url:"../../../server/cart.php",data:"type=delete&user_id="+e+"&goods_id="+s,dataType:"json",success:function(s){"success"==s.status&&(i(),n(),c(),sum())}})})});